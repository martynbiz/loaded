"undefined"==typeof loaded&&(loaded={}),loaded.cache=function(){var e={},t=function(t){return e[t]},n=function(t,n){e[t]=n},o=function(){e={}};return{get:t,set:n,flush:o}}(),"undefined"==typeof loaded&&(loaded={}),loaded.http=function(){var e={},t=function(e,t){switch(t.toUpperCase()){case"JSON":e=JSON.parse(e)}return e},n=function(){return e},o=function(t,n){e={status:t.status,data:n}},a=function(e){if(e=loaded.utils.extend({success:function(){console.log("loaded.http: Success handler not defined")},error:function(){console.log("loaded.http: Error handler not defined")},get_cached:!1,method:"GET",data_type:"text",data:null},e),e.get_cached&&loaded.cache.get(e.url))return e.success(t(loaded.cache.get(e.url),e.data_type),e.data_type),!0;var n;if(n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n.onreadystatechange=function(){if(4==n.readyState){var a=t(n.responseText,e.data_type);o(n,a),200==n.status?(loaded.cache.set(e.url,n.responseText,e.data_type),e.success(a)):e.error(a)}},n.open(e.method.toUpperCase(),e.url,!0),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"===e.method.toUpperCase()){n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var a=function(e){var t=[];for(var n in e)t.push(n+"="+e[n]);return t.join("&")}(e.data);n.send(a)}else n.send()};return{options:{},send:a,getLastResponse:n}}(),"undefined"==typeof loaded&&(loaded={}),loaded.dispatch=function(){function e(e,t){t=loaded.utils.extend({get_cached:!1},t),e&&(a=null,r=!1,loaded.http.send({url:e,method:"GET",data_type:"json",get_cached:t.get_cached,success:function(e){c(e),l()},error:function(){var e=loaded.http.getLastResponse();d.error(e)}}))}var t={},n=null,o=!0,a=null,r=!0,d={templates_dir:"/templates",container_id:"loaded-content",debug_mode:!1,render:function(){console.log("loaded.dispatch: config.render function not defined")},error:function(){console.log("loaded.dispatch: config.error_handler function not defined")}},u=function(e){n=e,o=!0},i=function(){return a},c=function(e){a=e,r=!0};_loadTemplate=function(e,a){a=loaded.utils.extend({get_cached:!0},a),e=d.templates_dir+e;var r=t[e];r?(u(r),l()):(n=null,o=!1,loaded.http.send({url:e,method:"GET",get_cached:a.get_cached,success:function(e){u(e),l()}}))};var l=function(){return o&&r?(d.render(n,a),void loaded.dispatch.init(p())):!1},s=function(e,t){return"string"==typeof e?d[e]=t:d=loaded.utils.extend(d,e),d},f=function(e){return d[e]},p=function(){return document.getElementById(d.container_id)},h=function(e){1==f("debug_mode")&&console.log("Loaded: Debug mode is ON"),e=e||document;for(var t=e.getElementsByTagName("a"),n=0;n<t.length;n++)t[n].addEventListener("click",function(e){if(1==f("debug_mode")&&e.preventDefault(),"#"!=this.getAttribute("href")){var t=this,n=loaded.router.match(this.getAttribute("href"),"GET"),o=loaded.router.getCurrentLayout(),a=n&&void 0!=n.layout,r=null!=o&&n.layout!=o;if(!a||!r){var d=n&&"function"==typeof n.value;d&&(n.value(t.href),history.pushState({},"",t.href),t.blur(),e.preventDefault())}}},!1);var o=loaded.router.match(window.location.pathname,"GET");o&&loaded.router.setCurrentLayout(o.layout),window.addEventListener("popstate",function(e){var t=loaded.router.match(window.location.pathname,"GET"),n=loaded.router.getCurrentLayout(),o=t&&void 0!=t.layout,a=null!=n&&t.layout!=n;o&&a&&(window.location.href=window.location.pathname);var r=t&&"function"==typeof t.value;r&&t.value(window.location.pathname)})};return{loadData:e,loadTemplate:_loadTemplate,getConfig:f,setConfig:s,getData:i,setData:c,getContainer:p,init:h}}(),"undefined"==typeof loaded&&(loaded={}),loaded.router=function(e){var t={},n=null,o="",a=function(e,n){if(!e)return void 0;"/"!=e&&"/"===e.substr(-1)&&(e=e.substr(0,e.length-1)),n||(n="GET");for(var o in t)if(result=r(e,n,t[o],o),result)return result},r=function(e,t,n,o,a,d){a||(a="");for(var u in n)if("/"===u.charAt(0))d=r(e,t,n[u],o,a+u,d);else{if(u!=t)continue;a.length>1&&(a=a.replace(/\/+$/,"")),a="^"+a+"$";var i=new RegExp(a),c=i.exec(e);c&&(c.shift(),d={},d.value=n[u],d.params=c,d.layout=o)}return d},d=function(e,t){return l(e,"GET",t)},u=function(e,t){return l(e,"POST",t)},i=function(e,t){return l(e,"PUT",t)},c=function(e,t){return l(e,"DELETE",t)},l=function(e,a,r){var e=o+e;t[n]=t[n]||{},t[n][e]=t[n][e]||{},t[n][e][a]=r},s=function(e,t){var o=n;n=e,t(),n=o},f=function(e,t){var n=o;o+=e,t(),o=n},p=function(e){return n},h=function(e){n=e},g=function(){return t};return{match:a,get:d,post:u,put:i,"delete":c,layout:s,group:f,setCurrentLayout:h,getCurrentLayout:p,getRoutes:g}}(),"undefined"==typeof loaded&&(loaded={}),loaded.utils=function(){var e=function(){for(var e={},t=0;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e};return{extend:e}}();