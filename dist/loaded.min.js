"undefined"==typeof loaded&&(loaded={}),loaded.cache=function(){var e={},t=function(t){return e[t]},n=function(t,n){e[t]=n},r=function(){return e={}};return{get:t,insert:n,clean:r}}(),"undefined"==typeof loaded&&(loaded={}),loaded.ajax=function(){var e=function(e,t){switch(t.toUpperCase()){case"JSON":e=JSON.parse(e)}return e},t=function(t){if(t=loaded.utils.extend({success:function(){},cache:!1,method:"GET",dataType:"text",data:null},t),t.cache&&_Cache.get(t.url))return t.success(e(_Cache.get(t.url),t.dataType),t.dataType),!0;var n;if(n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n.onreadystatechange=function(){4==n.readyState&&200==n.status&&(_Cache.insert(t.url,n.responseText,t.dataType),t.success(e(n.responseText,t.dataType)))},n.open(t.method.toUpperCase(),t.url,!0),"POST"===t.method.toUpperCase()){n.setRequestHeader("Content-type","application/x-www-form-urlencoded");var r=function(e){var t=[];for(var n in e)t.push(n+"="+e[n]);return t.join("&")}(t.data);n.send(r)}else n.send()};return _this={options:{},fetch:t}}(),"undefined"==typeof loaded&&(loaded={}),loaded.dispatch=function(){function e(e){e&&(o=null,u=!1,$.ajax({url:e,method:"GET",dataType:"json"}).done(function(e){d(e),l()}))}var t=function(e){_initLinks=e,_initLinks(document)},n={},r=null,a=!0,o=null,u=!0,i=function(e){r=e,a=!0},d=function(e){o=e,u=!0};_loadTemplate=function(e){e=c.templates_dir+e;var t=n[e];t?(i(t),l()):(r=null,a=!1,$.ajax({url:e,method:"GET"}).done(function(t){n[e]=t,i(t),l()}))};var l=function(){if(!a||!u)return!1;var e=Handlebars.compile(r),t=document.getElementById("content");t.innerHTML=e(o),_initLinks(t)},c={templates_dir:""},f=function(e){return c=loaded.utils.extend(c,e)};return{loadData:e,loadTemplate:_loadTemplate,init:t,config:f}}(),"undefined"==typeof loaded&&(loaded={}),loaded.router=function(e){var t={},n=null,r="",a=function(e,n){if(!e)return void 0;"/"!=e&&"/"===e.substr(-1)&&(e=e.substr(0,e.length-1)),n||(n="GET");for(var r in t)if(result=o(e,n,t[r],r),result)return result},o=function(e,t,n,r,a,u){a||(a="");for(var i in n)if("/"===i.charAt(0))u=o(e,t,n[i],r,a+i,u);else{if(i!=t)continue;a.length>1&&(a=a.replace(/\/+$/,"")),a="^"+a+"$";var d=new RegExp(a),l=d.exec(e);l&&(l.shift(),u={},u.value=n[i],u.params=l,u.layout=r)}return u},u=function(e,t){return c(e,"GET",t)},i=function(e,t){return c(e,"POST",t)},d=function(e,t){return c(e,"PUT",t)},l=function(e,t){return c(e,"DELETE",t)},c=function(e,a,o){var e=r+e;t[n]=t[n]||{},t[n][e]=t[n][e]||{},t[n][e][a]=o},f=function(e,t){var r=n;n=e,t(),n=r},s=function(e,t){var n=r;r+=e,t(),r=n},p=function(e){return n},h=function(e){n=e},v=function(){return t};return _this={match:a,get:u,post:i,put:d,"delete":l,layout:f,group:s,setCurrentLayout:h,getCurrentLayout:p,getRoutes:v}}(),"undefined"==typeof loaded&&(loaded={}),loaded.utils=function(){var e=function(){for(var e={},t=0;t<arguments.length;t++)for(var n in arguments[t])e[n]=arguments[t][n];return e};return{extend:e}}(),function(){var e=loaded.router.match(window.location.pathname,"GET");e&&loaded.router.setCurrentLayout(e.layout),loaded.dispatch.init(function(e){for(var t=e.getElementsByTagName("a"),n=0;n<t.length;n++)t[n].addEventListener("click",function(e){var t=this,n=loaded.router.match(this.getAttribute("href"),"GET"),r=loaded.router.getCurrentLayout(),a=n&&void 0!=n.layout,o=null!=r&&n.layout!=r;if(!a||!o){var u=n&&"function"==typeof n.value;u&&(n.value(t.href),history.pushState({},"",t.href),t.blur(),e.preventDefault())}},!1)})}();